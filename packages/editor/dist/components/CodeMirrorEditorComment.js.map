{"version":3,"file":"CodeMirrorEditorComment.js","sources":["../../src/components/CodeMirrorEditorComment.tsx"],"sourcesContent":["import { useEffect } from 'react';\n\nimport type { Extension } from '@codemirror/state';\nimport { keymap, scrollPastEnd } from '@codemirror/view';\n\nimport { GlobalCodeMirrorEditorKey } from '../consts';\nimport { useCodeMirrorEditorIsolated } from '../stores';\n\nimport { CodeMirrorEditor } from '.';\n\n\nconst additionalExtensions: Extension[] = [\n  scrollPastEnd(),\n];\n\n\ntype Props = {\n  onChange?: (value: string) => void,\n  onComment?: () => void,\n}\n\nexport const CodeMirrorEditorComment = (props: Props): JSX.Element => {\n  const {\n    onComment, onChange,\n  } = props;\n\n  const { data: codeMirrorEditor } = useCodeMirrorEditorIsolated(GlobalCodeMirrorEditorKey.COMMENT);\n\n  // setup additional extensions\n  useEffect(() => {\n    return codeMirrorEditor?.appendExtensions?.(additionalExtensions);\n  }, [codeMirrorEditor]);\n\n  // set handler to comment with ctrl/cmd + Enter key\n  useEffect(() => {\n    if (onComment == null) {\n      return;\n    }\n\n    const keymapExtension = keymap.of([\n      {\n        key: 'Mod-Enter',\n        preventDefault: true,\n        run: () => {\n          const doc = codeMirrorEditor?.getDoc();\n          if (doc != null) {\n            onComment();\n          }\n          return true;\n        },\n      },\n    ]);\n\n    const cleanupFunction = codeMirrorEditor?.appendExtensions?.(keymapExtension);\n\n    return cleanupFunction;\n  }, [codeMirrorEditor, onComment]);\n\n  return (\n    <CodeMirrorEditor\n      editorKey={GlobalCodeMirrorEditorKey.COMMENT}\n      onChange={onChange}\n    />\n  );\n};\n"],"names":["additionalExtensions","scrollPastEnd","CodeMirrorEditorComment","props","onComment","onChange","codeMirrorEditor","useCodeMirrorEditorIsolated","GlobalCodeMirrorEditorKey","useEffect","_a","keymapExtension","keymap","jsx","CodeMirrorEditor"],"mappings":";;;;;;;AAWA,MAAMA,IAAoC;AAAA,EACxCC,EAAc;AAChB,GAQaC,IAA0B,CAACC,MAA8B;AAC9D,QAAA;AAAA,IACJ,WAAAC;AAAA,IAAW,UAAAC;AAAA,EACT,IAAAF,GAEE,EAAE,MAAMG,EAAA,IAAqBC,EAA4BC,EAA0B,OAAO;AAGhG,SAAAC,EAAU,MAAM;;AACP,YAAAC,IAAAJ,KAAA,gBAAAA,EAAkB,qBAAlB,gBAAAI,EAAA,KAAAJ,GAAqCN;AAAA,EAAoB,GAC/D,CAACM,CAAgB,CAAC,GAGrBG,EAAU,MAAM;;AACd,QAAIL,KAAa;AACf;AAGI,UAAAO,IAAkBC,EAAO,GAAG;AAAA,MAChC;AAAA,QACE,KAAK;AAAA,QACL,gBAAgB;AAAA,QAChB,KAAK,QACSN,KAAA,gBAAAA,EAAkB,aACnB,QACCF,KAEL;AAAA,MAEX;AAAA,IAAA,CACD;AAIM,YAFiBM,IAAAJ,KAAA,gBAAAA,EAAkB,qBAAlB,gBAAAI,EAAA,KAAAJ,GAAqCK;AAAA,EAEtD,GACN,CAACL,GAAkBF,CAAS,CAAC,GAG9B,gBAAAS;AAAA,IAACC;AAAA,IAAA;AAAA,MACC,WAAWN,EAA0B;AAAA,MACrC,UAAAH;AAAA,IAAA;AAAA,EAAA;AAGN;"}