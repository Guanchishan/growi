{"version":3,"file":"CodeMirrorEditorMain.js","sources":["../../src/components/CodeMirrorEditorMain.tsx"],"sourcesContent":["import { useEffect } from 'react';\n\nimport type { Extension } from '@codemirror/state';\nimport { keymap, scrollPastEnd } from '@codemirror/view';\n\nimport { GlobalCodeMirrorEditorKey } from '../consts';\nimport { useCodeMirrorEditorIsolated } from '../stores';\n\nimport { CodeMirrorEditor } from '.';\n\n\nconst additionalExtensions: Extension[] = [\n  scrollPastEnd(),\n];\n\n\ntype Props = {\n  onChange?: (value: string) => void,\n  onSave?: () => void,\n  indentSize?: number,\n}\n\nexport const CodeMirrorEditorMain = (props: Props): JSX.Element => {\n  const {\n    onSave, onChange, indentSize,\n  } = props;\n\n  const { data: codeMirrorEditor } = useCodeMirrorEditorIsolated(GlobalCodeMirrorEditorKey.MAIN);\n\n  // setup additional extensions\n  useEffect(() => {\n    return codeMirrorEditor?.appendExtensions?.(additionalExtensions);\n  }, [codeMirrorEditor]);\n\n  // set handler to save with shortcut key\n  useEffect(() => {\n    if (onSave == null) {\n      return;\n    }\n\n    const extension = keymap.of([\n      {\n        key: 'Mod-s',\n        preventDefault: true,\n        run: () => {\n          const doc = codeMirrorEditor?.getDoc();\n          if (doc != null) {\n            onSave();\n          }\n          return true;\n        },\n      },\n    ]);\n\n    const cleanupFunction = codeMirrorEditor?.appendExtensions?.(extension);\n\n    return cleanupFunction;\n  }, [codeMirrorEditor, onSave]);\n\n  return (\n    <CodeMirrorEditor\n      editorKey={GlobalCodeMirrorEditorKey.MAIN}\n      onChange={onChange}\n      indentSize={indentSize}\n    />\n  );\n};\n"],"names":["additionalExtensions","scrollPastEnd","CodeMirrorEditorMain","props","onSave","onChange","indentSize","codeMirrorEditor","useCodeMirrorEditorIsolated","GlobalCodeMirrorEditorKey","useEffect","_a","extension","keymap","jsx","CodeMirrorEditor"],"mappings":";;;;;;AAWA,MAAMA,IAAoC;AAAA,EACxCC,EAAc;AAChB,GASaC,IAAuB,CAACC,MAA8B;AAC3D,QAAA;AAAA,IACJ,QAAAC;AAAA,IAAQ,UAAAC;AAAA,IAAU,YAAAC;AAAA,EAChB,IAAAH,GAEE,EAAE,MAAMI,EAAA,IAAqBC,EAA4BC,EAA0B,IAAI;AAG7F,SAAAC,EAAU,MAAM;;AACP,YAAAC,IAAAJ,KAAA,gBAAAA,EAAkB,qBAAlB,gBAAAI,EAAA,KAAAJ,GAAqCP;AAAA,EAAoB,GAC/D,CAACO,CAAgB,CAAC,GAGrBG,EAAU,MAAM;;AACd,QAAIN,KAAU;AACZ;AAGI,UAAAQ,IAAYC,EAAO,GAAG;AAAA,MAC1B;AAAA,QACE,KAAK;AAAA,QACL,gBAAgB;AAAA,QAChB,KAAK,QACSN,KAAA,gBAAAA,EAAkB,aACnB,QACFH,KAEF;AAAA,MAEX;AAAA,IAAA,CACD;AAIM,YAFiBO,IAAAJ,KAAA,gBAAAA,EAAkB,qBAAlB,gBAAAI,EAAA,KAAAJ,GAAqCK;AAAA,EAEtD,GACN,CAACL,GAAkBH,CAAM,CAAC,GAG3B,gBAAAU;AAAA,IAACC;AAAA,IAAA;AAAA,MACC,WAAWN,EAA0B;AAAA,MACrC,UAAAJ;AAAA,MACA,YAAAC;AAAA,IAAA;AAAA,EAAA;AAGN;"}