{"version":3,"file":"CodeMirrorEditor.js","sources":["../../../src/components/CodeMirrorEditor/CodeMirrorEditor.tsx"],"sourcesContent":["import {\n  forwardRef, useMemo, useRef, useEffect,\n} from 'react';\n\nimport { indentUnit } from '@codemirror/language';\nimport type { ReactCodeMirrorProps } from '@uiw/react-codemirror';\n\nimport { GlobalCodeMirrorEditorKey } from '../../consts';\nimport { useCodeMirrorEditorIsolated } from '../../stores';\n\nimport { Toolbar } from './Toolbar';\n\nimport style from './CodeMirrorEditor.module.scss';\n\nconst CodeMirrorEditorContainer = forwardRef<HTMLDivElement>((props, ref) => {\n  return (\n    <div {...props} className={`flex-expand-vert ${style['codemirror-editor-container']}`} ref={ref} />\n  );\n});\n\n\ntype Props = {\n  editorKey: string | GlobalCodeMirrorEditorKey,\n  onChange?: (value: string) => void,\n  indentSize?: number,\n}\n\nexport const CodeMirrorEditor = (props: Props): JSX.Element => {\n  const {\n    editorKey,\n    onChange,\n    indentSize,\n  } = props;\n\n  const containerRef = useRef(null);\n\n  const cmProps = useMemo<ReactCodeMirrorProps>(() => {\n    return {\n      onChange,\n    };\n  }, [onChange]);\n  const { data: codeMirrorEditor } = useCodeMirrorEditorIsolated(editorKey, containerRef.current, cmProps);\n\n  useEffect(() => {\n    if (indentSize == null) {\n      return;\n    }\n    const extension = indentUnit.of(' '.repeat(indentSize));\n\n    const cleanupFunction = codeMirrorEditor?.appendExtensions?.(extension);\n    return cleanupFunction;\n\n  }, [codeMirrorEditor, indentSize]);\n\n  return (\n    <div className=\"flex-expand-vert\">\n      <CodeMirrorEditorContainer ref={containerRef} />\n      <Toolbar />\n    </div>\n  );\n};\n"],"names":["CodeMirrorEditorContainer","forwardRef","props","ref","jsx","style","CodeMirrorEditor","editorKey","onChange","indentSize","containerRef","useRef","cmProps","useMemo","codeMirrorEditor","useCodeMirrorEditorIsolated","useEffect","extension","indentUnit","_a","jsxs","Toolbar"],"mappings":";;;;;;AAcA,MAAMA,IAA4BC,EAA2B,CAACC,GAAOC,MAEjE,gBAAAC,EAAC,OAAK,EAAA,GAAGF,GAAO,WAAW,oBAAoBG,EAAM,6BAA6B,CAAC,IAAI,KAAAF,EAAU,CAAA,CAEpG,GASYG,IAAmB,CAACJ,MAA8B;AACvD,QAAA;AAAA,IACJ,WAAAK;AAAA,IACA,UAAAC;AAAA,IACA,YAAAC;AAAA,EACE,IAAAP,GAEEQ,IAAeC,EAAO,IAAI,GAE1BC,IAAUC,EAA8B,OACrC;AAAA,IACL,UAAAL;AAAA,EAAA,IAED,CAACA,CAAQ,CAAC,GACP,EAAE,MAAMM,MAAqBC,EAA4BR,GAAWG,EAAa,SAASE,CAAO;AAEvG,SAAAI,EAAU,MAAM;;AACd,QAAIP,KAAc;AAChB;AAEF,UAAMQ,IAAYC,EAAW,GAAG,IAAI,OAAOT,CAAU,CAAC;AAG/C,YADiBU,IAAAL,KAAA,gBAAAA,EAAkB,qBAAlB,gBAAAK,EAAA,KAAAL,GAAqCG;AAAA,EACtD,GAEN,CAACH,GAAkBL,CAAU,CAAC,GAG/B,gBAAAW,EAAC,OAAI,EAAA,WAAU,oBACb,UAAA;AAAA,IAAC,gBAAAhB,EAAAJ,GAAA,EAA0B,KAAKU,EAAc,CAAA;AAAA,sBAC7CW,GAAQ,EAAA;AAAA,EACX,EAAA,CAAA;AAEJ;"}